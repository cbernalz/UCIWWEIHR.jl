var documenterSearchIndex = {"docs":
[{"location":"tutorial_index/#tutorial_home","page":"TUTORIAL CONTENTS","title":"Tutorial Contents","text":"","category":"section"},{"location":"tutorial_index/","page":"TUTORIAL CONTENTS","title":"TUTORIAL CONTENTS","text":"Future Description.","category":"page"},{"location":"tutorial_index/#Contents","page":"TUTORIAL CONTENTS","title":"Contents","text":"","category":"section"},{"location":"tutorial_index/","page":"TUTORIAL CONTENTS","title":"TUTORIAL CONTENTS","text":"Getting Started\nGenerating simulated data with UCIWWEIHR ODE compartmental based model.\nGenerating simulated data with an agent based model.\nGenerating posterior distribution samples with UCIWWEIHR ODE compartmental based model without forecasting.\nGenerating posterior distribution samples with UCIWWEIHR ODE compartmental based model with forecasting.\nGenerating repeated forecasts using the UCIWWEIHR model.","category":"page"},{"location":"tutorials/uciwweihr_model_repeated_forecasts/","page":"UCIWWEIHR REPEATED FORECASTING","title":"UCIWWEIHR REPEATED FORECASTING","text":"using Plots, StatsPlots; gr()\nPlots.reset_defaults()\n","category":"page"},{"location":"tutorials/uciwweihr_model_repeated_forecasts/#uciwwiehr_model_repeated_forecasts","page":"UCIWWEIHR REPEATED FORECASTING","title":"Generating Repeated Forecasts Using the UCIWWEIHR model.","text":"","category":"section"},{"location":"tutorials/uciwweihr_model_repeated_forecasts/","page":"UCIWWEIHR REPEATED FORECASTING","title":"UCIWWEIHR REPEATED FORECASTING","text":"Here we show how we can construct repeated forecasts using the UCIWWEIHR model.  We start with generating out data using generate_simulation_data_uciwweihr's alternate parameterization where we do prespecify the effective reproduction number and hospitalization probability.  ","category":"page"},{"location":"tutorials/uciwweihr_model_repeated_forecasts/#1.-Data-Generation.","page":"UCIWWEIHR REPEATED FORECASTING","title":"1. Data Generation.","text":"","category":"section"},{"location":"tutorials/uciwweihr_model_repeated_forecasts/","page":"UCIWWEIHR REPEATED FORECASTING","title":"UCIWWEIHR REPEATED FORECASTING","text":"Here we simulate a dataset, one with 175 time points.  ","category":"page"},{"location":"tutorials/uciwweihr_model_repeated_forecasts/","page":"UCIWWEIHR REPEATED FORECASTING","title":"UCIWWEIHR REPEATED FORECASTING","text":"using UCIWWEIHR\n# Running simulation function with presets\nrt_custom = vcat(\n    range(1, stop=1.8, length=7*4),\n    fill(1.8, 7*2),\n    range(1.8, stop=1, length=7*8),\n    range(0.98, stop=0.8, length=7*2),\n    range(0.8, stop=1.1, length=7*6),\n    range(1.1, stop=0.97, length=7*3)\n)\nw_custom = vcat(\n    range(0.3, stop=0.38, length=7*5),\n    fill(0.38, 7*2),\n    range(0.38, stop=0.25, length=7*8),\n    range(0.25, stop=0.28, length=7*2),\n    range(0.28, stop=0.34, length=7*6),\n    range(0.34, stop=0.28, length=7*2)\n)\nparams = create_uciwweihr_sim_params(\n    time_points = length(rt_custom),\n    Rt = rt_custom, \n    w = w_custom\n)\ndf = generate_simulation_data_uciwweihr(params)\nfirst(df, 5)","category":"page"},{"location":"tutorials/uciwweihr_model_repeated_forecasts/#2.-Constructing-Repeat-Forecasts.","page":"UCIWWEIHR REPEATED FORECASTING","title":"2. Constructing Repeat Forecasts.","text":"","category":"section"},{"location":"tutorials/uciwweihr_model_repeated_forecasts/","page":"UCIWWEIHR REPEATED FORECASTING","title":"UCIWWEIHR REPEATED FORECASTING","text":"We use the repeated_forecast function to generate forecasts for a given number of weeks, for a given number of time points.  Along with this we need to specify presets.  Output of this function is an array with the first index controlling which result we are looking at.  The next contains a uciwweihr_gq_pp output.","category":"page"},{"location":"tutorials/uciwweihr_model_repeated_forecasts/","page":"UCIWWEIHR REPEATED FORECASTING","title":"UCIWWEIHR REPEATED FORECASTING","text":"data_hosp = df.hosp\ndata_wastewater = df.log_ww_conc\nobstimes_hosp = df.obstimes\nobstimes_wastewater = df.obstimes\nmax_obstime = max(length(obstimes_hosp), length(obstimes_wastewater))\nparam_change_times = 1:7:max_obstime # Change every week\npriors_only = false\nn_samples = 200\nn_forecast_weeks = 2\nforecast_points = [\n    param_change_times[end-5],\n    param_change_times[end-4],\n    param_change_times[end-3],\n    param_change_times[end-2]\n]\n\nmodel_params = create_uciwweihr_model_params()\n\nrep_results = repeated_forecast(\n    data_hosp,\n    data_wastewater,\n    obstimes_hosp,\n    obstimes_wastewater;\n    n_samples = n_samples,\n    params = model_params,\n    n_forecast_weeks = 2,\n    forecast_points = forecast_points\n)\n\nfirst(rep_results, 2)","category":"page"},{"location":"tutorials/uciwweihr_model_repeated_forecasts/#3.-Visualizing-Results-Of-Repeated-Forecasts.","page":"UCIWWEIHR REPEATED FORECASTING","title":"3. Visualizing Results Of Repeated Forecasts.","text":"","category":"section"},{"location":"tutorials/uciwweihr_model_repeated_forecasts/","page":"UCIWWEIHR REPEATED FORECASTING","title":"UCIWWEIHR REPEATED FORECASTING","text":"We can take a look at these forecasts using the uciwweihr_visualizer function.  We can also add certain parameters to ensure we only see the plots we want.","category":"page"},{"location":"tutorials/uciwweihr_model_repeated_forecasts/","page":"UCIWWEIHR REPEATED FORECASTING","title":"UCIWWEIHR REPEATED FORECASTING","text":"for res_index in 1:length(forecast_points)\n    uciwweihr_visualizer(\n        data_hosp, \n        data_wastewater,\n        n_forecast_weeks,\n        obstimes_hosp,\n        obstimes_wastewater,\n        param_change_times,\n        2024,\n        true,\n        model_params;\n        pp_samples = rep_results[res_index][2][1],\n        gq_samples = rep_results[res_index][2][2],\n        obs_data_hosp = data_hosp,\n        obs_data_wastewater = data_wastewater, \n        actual_rt_vals = df.rt, \n        actual_w_t = df.wt, \n        actual_non_time_varying_vals = params,\n        bayes_dist_type = \"Posterior\",\n        mcmcdaigs = false,\n        time_varying_plots = false,\n        non_time_varying_plots = false,\n        pred_param_plots = true,\n        save_plots = true,\n        plot_name_to_save_pred_param = \"mcmc_pred_parameter_plots_rep_res\"*string(res_index)\n    )\nend","category":"page"},{"location":"tutorials/uciwweihr_model_repeated_forecasts/#3.1.-Forecast-Point-1.","page":"UCIWWEIHR REPEATED FORECASTING","title":"3.1. Forecast Point 1.","text":"","category":"section"},{"location":"tutorials/uciwweihr_model_repeated_forecasts/","page":"UCIWWEIHR REPEATED FORECASTING","title":"UCIWWEIHR REPEATED FORECASTING","text":"(Image: Plot 1)","category":"page"},{"location":"tutorials/uciwweihr_model_repeated_forecasts/#3.2.-Forecast-Point-2.","page":"UCIWWEIHR REPEATED FORECASTING","title":"3.2. Forecast Point 2.","text":"","category":"section"},{"location":"tutorials/uciwweihr_model_repeated_forecasts/","page":"UCIWWEIHR REPEATED FORECASTING","title":"UCIWWEIHR REPEATED FORECASTING","text":"(Image: Plot 2)","category":"page"},{"location":"tutorials/uciwweihr_model_repeated_forecasts/#3.3.-Forecast-Point-3.","page":"UCIWWEIHR REPEATED FORECASTING","title":"3.3. Forecast Point 3.","text":"","category":"section"},{"location":"tutorials/uciwweihr_model_repeated_forecasts/","page":"UCIWWEIHR REPEATED FORECASTING","title":"UCIWWEIHR REPEATED FORECASTING","text":"(Image: Plot 3)","category":"page"},{"location":"tutorials/uciwweihr_model_repeated_forecasts/#3.4.-Forecast-Point-4.","page":"UCIWWEIHR REPEATED FORECASTING","title":"3.4. Forecast Point 4.","text":"","category":"section"},{"location":"tutorials/uciwweihr_model_repeated_forecasts/","page":"UCIWWEIHR REPEATED FORECASTING","title":"UCIWWEIHR REPEATED FORECASTING","text":"(Image: Plot 4)","category":"page"},{"location":"tutorials/uciwweihr_model_repeated_forecasts/#[Tutorial-Contents](@ref-tutorial_home)","page":"UCIWWEIHR REPEATED FORECASTING","title":"Tutorial Contents","text":"","category":"section"},{"location":"license/#license","page":"LICENSE","title":"UCIWWEIHR.jl Package License","text":"","category":"section"},{"location":"license/","page":"LICENSE","title":"LICENSE","text":"The UCIWWEIHR.jl package is licensed under the MIT License.","category":"page"},{"location":"license/#MIT-License","page":"LICENSE","title":"MIT License","text":"","category":"section"},{"location":"license/","page":"LICENSE","title":"LICENSE","text":"MIT License","category":"page"},{"location":"license/","page":"LICENSE","title":"LICENSE","text":"Copyright (c) 2024 Christian O. Bernal Zelaya","category":"page"},{"location":"license/","page":"LICENSE","title":"LICENSE","text":"Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"Software\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:","category":"page"},{"location":"license/","page":"LICENSE","title":"LICENSE","text":"The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.","category":"page"},{"location":"license/","page":"LICENSE","title":"LICENSE","text":"THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.","category":"page"},{"location":"tutorials/uciwwiehr_model_fitting_forecast/","page":"UCIWWEIHR FITTING MODEL W/ FORECASTING","title":"UCIWWEIHR FITTING MODEL W/ FORECASTING","text":"using Plots, StatsPlots; gr()\nPlots.reset_defaults()\n","category":"page"},{"location":"tutorials/uciwwiehr_model_fitting_forecast/#uciwwiehr_model_fitting_with_forecast","page":"UCIWWEIHR FITTING MODEL W/ FORECASTING","title":"Generating Posterior Distribution Samples with UCIWWEIHR ODE Compartmental Based Model with Forecasting.","text":"","category":"section"},{"location":"tutorials/uciwwiehr_model_fitting_forecast/","page":"UCIWWEIHR FITTING MODEL W/ FORECASTING","title":"UCIWWEIHR FITTING MODEL W/ FORECASTING","text":"Here we extend the previous tutorial  to include forecasting capabilities.  We start with generating out data using generate_simulation_data_uciwweihr's alternate parameterization where we do not prespecify the effective reproduction number and hospitalization probability but instead preform a log-normal random walk and a logit-normal random walk respectively.  We then sample from the posterior distribution using the uciwweihr_fit.jl function.  We then generate desired quantities and forecast for a given time period with the posterior predictive distribution, using uciwweihr_gq_pp.jl.","category":"page"},{"location":"tutorials/uciwwiehr_model_fitting_forecast/#1.-Data-Generation.","page":"UCIWWEIHR FITTING MODEL W/ FORECASTING","title":"1. Data Generation.","text":"","category":"section"},{"location":"tutorials/uciwwiehr_model_fitting_forecast/","page":"UCIWWEIHR FITTING MODEL W/ FORECASTING","title":"UCIWWEIHR FITTING MODEL W/ FORECASTING","text":"Here we generate two datasets, one with 150 time points and one with 178 time points.  We will use the 150 time point dataset for fitting and the 178 time point dataset for forecast evaluation.","category":"page"},{"location":"tutorials/uciwwiehr_model_fitting_forecast/","page":"UCIWWEIHR FITTING MODEL W/ FORECASTING","title":"UCIWWEIHR FITTING MODEL W/ FORECASTING","text":"using UCIWWEIHR\n# Running simulation function with presets\nparams = create_uciwweihr_sim_params(\n    time_points = 150\n)\ndf = generate_simulation_data_uciwweihr(params)\n\nparams_ext = create_uciwweihr_sim_params(\n    time_points = 178\n)\ndf_ext = generate_simulation_data_uciwweihr(params_ext)\nfirst(df, 5)","category":"page"},{"location":"tutorials/uciwwiehr_model_fitting_forecast/","page":"UCIWWEIHR FITTING MODEL W/ FORECASTING","title":"UCIWWEIHR FITTING MODEL W/ FORECASTING","text":"first(df_ext, 5)","category":"page"},{"location":"tutorials/uciwwiehr_model_fitting_forecast/#2.-Sampling-from-the-Posterior-Distribution-and-Posterior-Predictive-Distribution.","page":"UCIWWEIHR FITTING MODEL W/ FORECASTING","title":"2. Sampling from the Posterior Distribution and Posterior Predictive Distribution.","text":"","category":"section"},{"location":"tutorials/uciwwiehr_model_fitting_forecast/","page":"UCIWWEIHR FITTING MODEL W/ FORECASTING","title":"UCIWWEIHR FITTING MODEL W/ FORECASTING","text":"Here we sample from the posterior distribution using the uciwweihr_fit.jl function.  First, we setup some presets, where we need to use create_uciwweihr_model_params() to get default parameters for the model.  Then we have an array where index 1 contains the posterior/prior predictive samples, index 2 contains the posterior/prior generated quantities samples, and index 3 contains the original sampled parameters for the model.  The difference here is that we set forecast = true and forecast_weeks = 4 to forecast 4 weeks into the future.  One other thing to note, is that we allow misalignment of hospital and wastewater data's observed times.  For this tutorial, we use the same observed points.","category":"page"},{"location":"tutorials/uciwwiehr_model_fitting_forecast/","page":"UCIWWEIHR FITTING MODEL W/ FORECASTING","title":"UCIWWEIHR FITTING MODEL W/ FORECASTING","text":"data_hosp = df.hosp\ndata_wastewater = df.log_ww_conc\nobstimes_hosp = df.obstimes\nobstimes_wastewater = df.obstimes\nmax_obstime = max(length(obstimes_hosp), length(obstimes_wastewater))\nparam_change_times = 1:7:max_obstime # Change every week\npriors_only = false\nn_samples = 200\nforecast = true\nforecast_weeks = 4\n\nmodel_params = create_uciwweihr_model_params()\nsamples = uciwweihr_fit(\n    data_hosp,\n    data_wastewater,\n    obstimes_hosp,\n    obstimes_wastewater;\n    param_change_times,\n    priors_only,\n    n_samples,\n    params = model_params\n)\nmodel_output = uciwweihr_gq_pp(\n    samples,\n    data_hosp,\n    data_wastewater,\n    obstimes_hosp,\n    obstimes_wastewater;\n    param_change_times = param_change_times,\n    params = model_params,\n    forecast = forecast,\n    forecast_weeks = forecast_weeks\n)\n\nfirst(model_output[1][:,1:5], 5)","category":"page"},{"location":"tutorials/uciwwiehr_model_fitting_forecast/","page":"UCIWWEIHR FITTING MODEL W/ FORECASTING","title":"UCIWWEIHR FITTING MODEL W/ FORECASTING","text":"first(model_output[2][:,1:5], 5)","category":"page"},{"location":"tutorials/uciwwiehr_model_fitting_forecast/","page":"UCIWWEIHR FITTING MODEL W/ FORECASTING","title":"UCIWWEIHR FITTING MODEL W/ FORECASTING","text":"first(model_output[3][:,1:5], 5)","category":"page"},{"location":"tutorials/uciwwiehr_model_fitting_forecast/#3.-MCMC-Diagnostic-Plots/Results-Along-with-Posterior-Predictive-Distribution.","page":"UCIWWEIHR FITTING MODEL W/ FORECASTING","title":"3. MCMC Diagnostic Plots/Results Along with Posterior Predictive Distribution.","text":"","category":"section"},{"location":"tutorials/uciwwiehr_model_fitting_forecast/","page":"UCIWWEIHR FITTING MODEL W/ FORECASTING","title":"UCIWWEIHR FITTING MODEL W/ FORECASTING","text":"We can again look at model diagnostics, posterior distribution of time or non-time varying parameters, and the posterior predictive distribution extended for forecasting.  We can also add certain parameters to ensure priors will be plotted alongside their corresponding posteriors.","category":"page"},{"location":"tutorials/uciwwiehr_model_fitting_forecast/","page":"UCIWWEIHR FITTING MODEL W/ FORECASTING","title":"UCIWWEIHR FITTING MODEL W/ FORECASTING","text":"uciwweihr_visualizer(\n    data_hosp, \n    data_wastewater,\n    forecast_weeks,\n    obstimes_hosp,\n    obstimes_wastewater,\n    param_change_times,\n    2024,\n    forecast,\n    model_params;\n    pp_samples = model_output[1],\n    gq_samples = model_output[2],\n    obs_data_hosp = df_ext.hosp,\n    obs_data_wastewater = df_ext.log_ww_conc, \n    actual_rt_vals = df_ext.rt, \n    actual_w_t = df_ext.wt, \n    actual_E_ode_sol = df.E_ode_comp_sol,\n    actual_I_ode_sol = df.I_ode_comp_sol,\n    actual_H_ode_sol = df.H_ode_comp_sol,\n    actual_non_time_varying_vals = params,\n    bayes_dist_type = \"Posterior\",\n    save_plots = true,\n    plot_name_to_save_mcmcdiag = \"mcmc_diagnosis_plots1\",\n    plot_name_to_save_time_varying = \"mcmc_time_varying_parameter_plots1\",\n    plot_name_to_save_non_time_varying = \"mcmc_nontime_varying_parameter_plots1\",\n    plot_name_to_save_ode_sol = \"mcmc_ode_solution_plots1\",\n    plot_name_to_save_pred_param = \"mcmc_pred_parameter_plots1\"\n)","category":"page"},{"location":"tutorials/uciwwiehr_model_fitting_forecast/#3.1.-MCMC-Diagnostic-Plots.","page":"UCIWWEIHR FITTING MODEL W/ FORECASTING","title":"3.1. MCMC Diagnostic Plots.","text":"","category":"section"},{"location":"tutorials/uciwwiehr_model_fitting_forecast/","page":"UCIWWEIHR FITTING MODEL W/ FORECASTING","title":"UCIWWEIHR FITTING MODEL W/ FORECASTING","text":"(Image: Plot 1)","category":"page"},{"location":"tutorials/uciwwiehr_model_fitting_forecast/#3.2.-Time-Varying-Parameter-Results-Plot.","page":"UCIWWEIHR FITTING MODEL W/ FORECASTING","title":"3.2. Time Varying Parameter Results Plot.","text":"","category":"section"},{"location":"tutorials/uciwwiehr_model_fitting_forecast/","page":"UCIWWEIHR FITTING MODEL W/ FORECASTING","title":"UCIWWEIHR FITTING MODEL W/ FORECASTING","text":"(Image: Plot 2)","category":"page"},{"location":"tutorials/uciwwiehr_model_fitting_forecast/#3.3.-Non-Time-Varying-Parameter-Results-Plot.","page":"UCIWWEIHR FITTING MODEL W/ FORECASTING","title":"3.3. Non-Time Varying Parameter Results Plot.","text":"","category":"section"},{"location":"tutorials/uciwwiehr_model_fitting_forecast/","page":"UCIWWEIHR FITTING MODEL W/ FORECASTING","title":"UCIWWEIHR FITTING MODEL W/ FORECASTING","text":"(Image: Plot 3)","category":"page"},{"location":"tutorials/uciwwiehr_model_fitting_forecast/#3.4.-ODE-Solution-Plot.","page":"UCIWWEIHR FITTING MODEL W/ FORECASTING","title":"3.4. ODE Solution Plot.","text":"","category":"section"},{"location":"tutorials/uciwwiehr_model_fitting_forecast/","page":"UCIWWEIHR FITTING MODEL W/ FORECASTING","title":"UCIWWEIHR FITTING MODEL W/ FORECASTING","text":"(Image: Plot 4)","category":"page"},{"location":"tutorials/uciwwiehr_model_fitting_forecast/#3.5.-Posterior-Predictive-Distribution-Plot.","page":"UCIWWEIHR FITTING MODEL W/ FORECASTING","title":"3.5. Posterior Predictive Distribution Plot.","text":"","category":"section"},{"location":"tutorials/uciwwiehr_model_fitting_forecast/","page":"UCIWWEIHR FITTING MODEL W/ FORECASTING","title":"UCIWWEIHR FITTING MODEL W/ FORECASTING","text":"(Image: Plot 4)","category":"page"},{"location":"tutorials/uciwwiehr_model_fitting_forecast/#[Tutorial-Contents](@ref-tutorial_home)","page":"UCIWWEIHR FITTING MODEL W/ FORECASTING","title":"Tutorial Contents","text":"","category":"section"},{"location":"tutorials/agent_based_simulation_data/#agent_based_simulation_data","page":"AGENT-BASED SIMULATION DATA","title":"Generating simulated data with an agent based model.","text":"","category":"section"},{"location":"tutorials/agent_based_simulation_data/","page":"AGENT-BASED SIMULATION DATA","title":"AGENT-BASED SIMULATION DATA","text":"This package provides a way to also simulate data using the agent based model in the future paper.  The function called generate_simulation_data_agent.jl can be used to generate synthetic data for a given population size and features.  Here we provide a demonstration using the default settings of generate_simulation_data_agent.jl :","category":"page"},{"location":"tutorials/agent_based_simulation_data/#1.-Functionality.","page":"AGENT-BASED SIMULATION DATA","title":"1. Functionality.","text":"","category":"section"},{"location":"tutorials/agent_based_simulation_data/","page":"AGENT-BASED SIMULATION DATA","title":"AGENT-BASED SIMULATION DATA","text":"using UCIWWEIHR\nusing Plots\n# Running simulation function with defaults\ndf = generate_simulation_data_agent()\nfirst(df, 5)","category":"page"},{"location":"tutorials/agent_based_simulation_data/#2.-Visualizing-SEIHR-compartments.","page":"AGENT-BASED SIMULATION DATA","title":"2. Visualizing SEIHR compartments.","text":"","category":"section"},{"location":"tutorials/agent_based_simulation_data/","page":"AGENT-BASED SIMULATION DATA","title":"AGENT-BASED SIMULATION DATA","text":"We can also use the Plots package to visualize the data generated.","category":"page"},{"location":"tutorials/agent_based_simulation_data/","page":"AGENT-BASED SIMULATION DATA","title":"AGENT-BASED SIMULATION DATA","text":"plot(df.Time, df.S, label = \"Suseptible\", \n    xlabel = \"Time\", \n    ylabel = \"Number of Individuals\", \n    title = \"Agent Based Model Simulation Results\")\nplot!(df.Time, df.E, label = \"Exposed\")\nplot!(df.Time, df.I, label = \"Infected\")\nplot!(df.Time, df.H, label = \"Hospitalized\")\nplot!(df.Time, df.R, label = \"Recovered\")","category":"page"},{"location":"tutorials/agent_based_simulation_data/#[Tutorial-Contents](@ref-tutorial_home)","page":"AGENT-BASED SIMULATION DATA","title":"Tutorial Contents","text":"","category":"section"},{"location":"tutorials/uciwwiehr_model_fitting_no_forecast/","page":"UCIWWEIHR FITTING MODEL W/OUT FORECASTING","title":"UCIWWEIHR FITTING MODEL W/OUT FORECASTING","text":"using Plots, StatsPlots; gr()\nPlots.reset_defaults()\n","category":"page"},{"location":"tutorials/uciwwiehr_model_fitting_no_forecast/#uciwwiehr_model_fitting_no_forecast","page":"UCIWWEIHR FITTING MODEL W/OUT FORECASTING","title":"Generating Posterior Distribution Samples with UCIWWEIHR ODE Compartmental Based Model without Forecasting.","text":"","category":"section"},{"location":"tutorials/uciwwiehr_model_fitting_no_forecast/","page":"UCIWWEIHR FITTING MODEL W/OUT FORECASTING","title":"UCIWWEIHR FITTING MODEL W/OUT FORECASTING","text":"This package has a way to sample from a posterior or prior that is defined in the future paper using the uciwweihr_fit.jl and uciwweihr_model.jl.  We can then generate desired quantities and forecast for a given time period with the posterior predictive distribution, using uciwweihr_gq_pp.jl.  We first generate data using the generate_simulation_data_uciwweihr function which is a non-mispecified version of the model, we will also be using prespecified effective reporduction curves and prespecified hospitalization probability curves.","category":"page"},{"location":"tutorials/uciwwiehr_model_fitting_no_forecast/#1.-Data-Generation.","page":"UCIWWEIHR FITTING MODEL W/OUT FORECASTING","title":"1. Data Generation.","text":"","category":"section"},{"location":"tutorials/uciwwiehr_model_fitting_no_forecast/","page":"UCIWWEIHR FITTING MODEL W/OUT FORECASTING","title":"UCIWWEIHR FITTING MODEL W/OUT FORECASTING","text":"using UCIWWEIHR\n# Running simulation function with presets\nrt_custom = vcat(\n    range(1, stop=1.8, length=7*4),\n    fill(1.8, 7*2),\n    range(1.8, stop=1, length=7*8),\n    range(0.98, stop=0.8, length=7*2),\n    range(0.8, stop=1.1, length=7*6),\n    range(1.1, stop=0.97, length=7*3)\n)\nw_custom = vcat(\n    range(0.3, stop=0.38, length=7*5),\n    fill(0.38, 7*2),\n    range(0.38, stop=0.25, length=7*8),\n    range(0.25, stop=0.28, length=7*2),\n    range(0.28, stop=0.34, length=7*6),\n    range(0.34, stop=0.28, length=7*2)\n)\nparams = create_uciwweihr_sim_params(\n    time_points = length(rt_custom),\n    Rt = rt_custom, \n    w = w_custom\n)\ndf = generate_simulation_data_uciwweihr(params)\nfirst(df, 5)","category":"page"},{"location":"tutorials/uciwwiehr_model_fitting_no_forecast/#2.-Sampling-from-the-Posterior-Distribution-and-Posterior-Predictive-Distribution.","page":"UCIWWEIHR FITTING MODEL W/OUT FORECASTING","title":"2. Sampling from the Posterior Distribution and Posterior Predictive Distribution.","text":"","category":"section"},{"location":"tutorials/uciwwiehr_model_fitting_no_forecast/","page":"UCIWWEIHR FITTING MODEL W/OUT FORECASTING","title":"UCIWWEIHR FITTING MODEL W/OUT FORECASTING","text":"Here we sample from the posterior distribution using the uciwweihr_fit.jl function.  First, we setup some presets, where we need to use create_uciwweihr_model_params() to get default parameters for the model.  Then we have an array where index 1 contains the posterior/prior predictive samples, index 2 contains the posterior/prior generated quantities samples, and index 3 contains the original sampled parameters for the model.  Again, we can allow misalignment of hospital and wastewater data's observed times.  For this tutorial, we use the same observed points.","category":"page"},{"location":"tutorials/uciwwiehr_model_fitting_no_forecast/","page":"UCIWWEIHR FITTING MODEL W/OUT FORECASTING","title":"UCIWWEIHR FITTING MODEL W/OUT FORECASTING","text":"data_hosp = df.hosp\ndata_wastewater = df.log_ww_conc\nobstimes_hosp = df.obstimes\nobstimes_wastewater = df.obstimes\nmax_obstime = max(length(obstimes_hosp), length(obstimes_wastewater))\nparam_change_times = 1:7:max_obstime # Change every week\npriors_only = false\nn_samples = 200\nforecast = false\nforecast_weeks = 0\n\nmodel_params = create_uciwweihr_model_params()\nsamples = uciwweihr_fit(\n    data_hosp,\n    data_wastewater,\n    obstimes_hosp,\n    obstimes_wastewater;\n    param_change_times,\n    priors_only,\n    n_samples,\n    params = model_params\n)\nmodel_output = uciwweihr_gq_pp(\n    samples,\n    data_hosp,\n    data_wastewater,\n    obstimes_hosp,\n    obstimes_wastewater;\n    param_change_times = param_change_times,\n    params = model_params\n)\n\nfirst(model_output[1][:,1:5], 5)","category":"page"},{"location":"tutorials/uciwwiehr_model_fitting_no_forecast/","page":"UCIWWEIHR FITTING MODEL W/OUT FORECASTING","title":"UCIWWEIHR FITTING MODEL W/OUT FORECASTING","text":"first(model_output[2][:,1:5], 5)","category":"page"},{"location":"tutorials/uciwwiehr_model_fitting_no_forecast/","page":"UCIWWEIHR FITTING MODEL W/OUT FORECASTING","title":"UCIWWEIHR FITTING MODEL W/OUT FORECASTING","text":"first(model_output[3][:,1:5], 5)","category":"page"},{"location":"tutorials/uciwwiehr_model_fitting_no_forecast/#3.-MCMC-Diagnostic-Plots/Results-Along-with-Posterior-Predictive-Distribution.","page":"UCIWWEIHR FITTING MODEL W/OUT FORECASTING","title":"3. MCMC Diagnostic Plots/Results Along with Posterior Predictive Distribution.","text":"","category":"section"},{"location":"tutorials/uciwwiehr_model_fitting_no_forecast/","page":"UCIWWEIHR FITTING MODEL W/OUT FORECASTING","title":"UCIWWEIHR FITTING MODEL W/OUT FORECASTING","text":"We also provide a very basic way to visualize some MCMC diagnostics along with effective sample sizes of desired generated quantities(does not include functionality for time-varying quantities).  Along with this, we can also visualize the posterior predictive distribution with actual observed values, which can be used to examine forecasts generated by the model.  We can also add certain parameters to ensure priors will be plotted alongside their corresponding posteriors.","category":"page"},{"location":"tutorials/uciwwiehr_model_fitting_no_forecast/","page":"UCIWWEIHR FITTING MODEL W/OUT FORECASTING","title":"UCIWWEIHR FITTING MODEL W/OUT FORECASTING","text":"uciwweihr_visualizer(\n    data_hosp, \n    data_wastewater,\n    forecast_weeks,\n    obstimes_hosp,\n    obstimes_wastewater,\n    param_change_times,\n    2024,\n    forecast,\n    model_params;\n    pp_samples = model_output[1],\n    gq_samples = model_output[2],\n    obs_data_hosp = data_hosp,\n    obs_data_wastewater = data_wastewater, \n    actual_rt_vals = df.rt, \n    actual_w_t = df.wt, \n    actual_E_ode_sol = df.E_ode_comp_sol,\n    actual_I_ode_sol = df.I_ode_comp_sol,\n    actual_H_ode_sol = df.H_ode_comp_sol,\n    actual_non_time_varying_vals = params,\n    bayes_dist_type = \"Posterior\",\n    save_plots = true\n)","category":"page"},{"location":"tutorials/uciwwiehr_model_fitting_no_forecast/#3.1.-MCMC-Diagnostic-Plots.","page":"UCIWWEIHR FITTING MODEL W/OUT FORECASTING","title":"3.1. MCMC Diagnostic Plots.","text":"","category":"section"},{"location":"tutorials/uciwwiehr_model_fitting_no_forecast/","page":"UCIWWEIHR FITTING MODEL W/OUT FORECASTING","title":"UCIWWEIHR FITTING MODEL W/OUT FORECASTING","text":"(Image: Plot 1)","category":"page"},{"location":"tutorials/uciwwiehr_model_fitting_no_forecast/#3.2.-Time-Varying-Parameter-Results-Plot.","page":"UCIWWEIHR FITTING MODEL W/OUT FORECASTING","title":"3.2. Time Varying Parameter Results Plot.","text":"","category":"section"},{"location":"tutorials/uciwwiehr_model_fitting_no_forecast/","page":"UCIWWEIHR FITTING MODEL W/OUT FORECASTING","title":"UCIWWEIHR FITTING MODEL W/OUT FORECASTING","text":"(Image: Plot 2)","category":"page"},{"location":"tutorials/uciwwiehr_model_fitting_no_forecast/#3.3.-Non-Time-Varying-Parameter-Results-Plot.","page":"UCIWWEIHR FITTING MODEL W/OUT FORECASTING","title":"3.3. Non-Time Varying Parameter Results Plot.","text":"","category":"section"},{"location":"tutorials/uciwwiehr_model_fitting_no_forecast/","page":"UCIWWEIHR FITTING MODEL W/OUT FORECASTING","title":"UCIWWEIHR FITTING MODEL W/OUT FORECASTING","text":"(Image: Plot 3)","category":"page"},{"location":"tutorials/uciwwiehr_model_fitting_no_forecast/#3.4.-ODE-Solution-Plot.","page":"UCIWWEIHR FITTING MODEL W/OUT FORECASTING","title":"3.4. ODE Solution Plot.","text":"","category":"section"},{"location":"tutorials/uciwwiehr_model_fitting_no_forecast/","page":"UCIWWEIHR FITTING MODEL W/OUT FORECASTING","title":"UCIWWEIHR FITTING MODEL W/OUT FORECASTING","text":"(Image: Plot 4)","category":"page"},{"location":"tutorials/uciwwiehr_model_fitting_no_forecast/#3.4.-Posterior-Predictive-Distribution-Plot.","page":"UCIWWEIHR FITTING MODEL W/OUT FORECASTING","title":"3.4. Posterior Predictive Distribution Plot.","text":"","category":"section"},{"location":"tutorials/uciwwiehr_model_fitting_no_forecast/","page":"UCIWWEIHR FITTING MODEL W/OUT FORECASTING","title":"UCIWWEIHR FITTING MODEL W/OUT FORECASTING","text":"(Image: Plot 4)","category":"page"},{"location":"tutorials/uciwwiehr_model_fitting_no_forecast/#[Tutorial-Contents](@ref-tutorial_home)","page":"UCIWWEIHR FITTING MODEL W/OUT FORECASTING","title":"Tutorial Contents","text":"","category":"section"},{"location":"tutorials/getting_started/#getting_started","page":"GETTING STARTED","title":"Getting Started","text":"","category":"section"},{"location":"tutorials/getting_started/","page":"GETTING STARTED","title":"GETTING STARTED","text":"Welcome to the Tutorials page for the UCIWWEIHR.jl project. This section provides step-by-step guides and examples to help you get started with using the package and understanding its features.","category":"page"},{"location":"tutorials/getting_started/#1.-Installation.","page":"GETTING STARTED","title":"1. Installation.","text":"","category":"section"},{"location":"tutorials/getting_started/","page":"GETTING STARTED","title":"GETTING STARTED","text":"To install the UCIWWEIHR.jl package, open the Julia REPL and run the following command:","category":"page"},{"location":"tutorials/getting_started/","page":"GETTING STARTED","title":"GETTING STARTED","text":"using Pkg\nPkg.add(\"https://github.com/cbernalz/UCIWWEIHR.jl.git\")","category":"page"},{"location":"tutorials/getting_started/#[Tutorial-Contents](@ref-tutorial_home)","page":"GETTING STARTED","title":"Tutorial Contents","text":"","category":"section"},{"location":"reference/#reference","page":"REFERENCE","title":"Reference","text":"","category":"section"},{"location":"reference/#Contents","page":"REFERENCE","title":"Contents","text":"","category":"section"},{"location":"reference/","page":"REFERENCE","title":"REFERENCE","text":"Pages = [\"reference.md\"]","category":"page"},{"location":"reference/#Index","page":"REFERENCE","title":"Index","text":"","category":"section"},{"location":"reference/","page":"REFERENCE","title":"REFERENCE","text":"Pages = [\"reference.md\"]","category":"page"},{"location":"reference/","page":"REFERENCE","title":"REFERENCE","text":"Modules = [UCIWWEIHR]","category":"page"},{"location":"reference/#UCIWWEIHR.uciwweihr_model_params","page":"REFERENCE","title":"UCIWWEIHR.uciwweihr_model_params","text":"uciwweihr_model_params\n\nStruct for holding parameters used in the UCIWWEIHR ODE compartmental model.  Use create_uciwweihr_model_params to create an instance of this struct.\n\nFields\n\nE_init_sd::Float64=50.0: Standard deviation for the initial number of exposed individuals.\nlog_E_init_mean::Int64=200: Mean for the initial number of exposed individuals, on log scale.\nI_init_sd::Float64=20.0: Standard deviation for the initial number of infected individuals.\nlog_I_init_mean::Int64=100: Mean for the initial number of infected individuals, on log scale.\nH_init_sd::Float64=5.0: Standard deviation for the initial number of hospitalized individuals.\nlog_H_init_mean::Int64=20: Mean for the initial number of hospitalized individuals, on log scale.\ngamma_sd::Float64=0.02: Standard deviation for the rate of incubation.\nlog_gamma_mean::Float64=log(1/4): Mean for the rate of incubation on log scale.\nnu_sd::Float64=0.02: Standard deviation for the rate of leaving the infected compartment.\nlog_nu_mean::Float64=log(1/7): Mean for the rate of leaving the infected compartment on the log scale.\nepsilon_sd::Float64=0.02: Standard deviation for the rate of hospitalization recovery.\nlog_epsilon_mean::Float64=log(1/5): Mean for the rate of hospitalization recovery on the log scale.\nrho_gene_sd::Float64=0.02: Standard deviation for the rho prior.\nlog_rho_gene_mean::Float64=log(0.011): Mean for the row prior on log scale.\nsigma_ww::Float64=log(0.1): Standard deviation for the normal distribution for wastewater data.  Not infered.\nsigma_hosp::Float64=500.0: Standard deviation for the negative binomial distribution for hospital data.  Not infered.\nRt_init_sd::Float64=0.3: Standard deviation for the initial value of the time-varying reproduction number.\nRt_init_mean::Float64=0.2: Mean for the initial value of the time-varying reproduction number.\nsigma_Rt_sd::Float64=0.2: Standard deviation for normal prior of log time-varying reproduction number standard deviation.\nsigma_Rt_mean::Float64=-3.0: Mean for normal prior of log time-varying reproduction number standard deviation.\nw_init_sd::Float64=0.1: Standard deviation for the initial value of the time-varying hospitalization rate.\nw_init_mean::Float64=log(0.35): Mean for the initial value of the time-varying hospitalization rate.\nsigma_w_sd::Float64=0.2: Standard deviation for normal prior of log time-varying hospitalization rate standard deviation.\nsigma_w_mean::Float64=-3.5: Mean for normal prior of time-varying hospitalization rate standard deviation.\n\n\n\n\n\n","category":"type"},{"location":"reference/#UCIWWEIHR.uciwweihr_sim_params","page":"REFERENCE","title":"UCIWWEIHR.uciwweihr_sim_params","text":"uciwweihr_sim_params\n\nStruct for holding parameters used in the UCIWWEIHR ODE compartmental model simulation.  Use create_uciwweihr_sim_params to create an instance of this struct.\n\nFields\n\ntime_points::Int64: Number of time points for the simulation.\nseed::Int64: Seed for random number generation.\nE_init::Int64: Initial number of exposed individuals.\nI_init::Int64: Initial number of infected individuals.\nH_init::Int64: Initial number of hospitalized individuals.\ngamma::Float64: Rate of incubation.\nnu::Float64: Rate of leaving the infected compartment.\nepsilon::Float64: Rate of hospitalization recovery.\nrho_gene::Float64: Contribution of infected individual's pathogen genome into wastewater.\nsigma_ww::Float64: standard deviation of the log concentration of pathogen genome in wastewater.\nsigma_hosp::Float64: Standard deviation for the negative binomial distribution for hospital data.\nRt::Union{Float64, Vector{Float64}}: Initial value or time series of the time-varying reproduction number.\nsigma_Rt::Float64: Standard deviation for random walk of time-varying reproduction number.\nw::Union{Float64, Vector{Float64}}: Initial value or time series of the time-varying hospitalization rate.\nsigma_w::Float64: Standard deviation for random walk of time-varying hospitalization rate.\nrt_init::Float64: Initial value of the time-varying reproduction number, NOT USER SPECIFIED create_uciwweihr_params TAKES CARE OF THIS.\nw_init::Float64: Initial value of the time-varying hospitalization rate, NOT USER SPECIFIED create_uciwweihr_params TAKES CARE OF THIS.\n\n\n\n\n\n","category":"type"},{"location":"reference/#UCIWWEIHR.ChainsCustomIndex-Tuple{MCMCChains.Chains, BitMatrix}","page":"REFERENCE","title":"UCIWWEIHR.ChainsCustomIndex","text":"ChainsCustomIndex(c::Chains, indices_to_keep::BitMatrix)\n\nReduce Chains object to only wanted indices. \n\nFunction created by Damon Bayer. \n\n\n\n\n\n","category":"method"},{"location":"reference/#UCIWWEIHR.NegativeBinomial2-Tuple{Any, Any}","page":"REFERENCE","title":"UCIWWEIHR.NegativeBinomial2","text":"Create a re-parametrized negative binomial distribution in terms of mean and overdispersion.\n\nArguments\n\nμ: Mean of the distribution.\nϕ: Overdispersion parameter.\n\nReturns\n\nA Distributions.NegativeBinomial distribution object.\n\n\n\n\n\n","category":"method"},{"location":"reference/#UCIWWEIHR.calculate_quantiles-NTuple{4, Any}","page":"REFERENCE","title":"UCIWWEIHR.calculate_quantiles","text":"calculate_quantiles(df, chain, var_prefix, quantiles)\n\nCalculate quantiles for a given chain and variable prefix.  Quantiles can be any user desired quantile.\n\n\n\n\n\n","category":"method"},{"location":"reference/#UCIWWEIHR.calculate_quantiles_without_chain-Tuple{Any, Any, Any}","page":"REFERENCE","title":"UCIWWEIHR.calculate_quantiles_without_chain","text":"calculate_quantiles_without_chain(df, var_prefix, quantiles)\n\nCalculates quantiles for a given variable prefix without considering the chain.\n\n\n\n\n\n","category":"method"},{"location":"reference/#UCIWWEIHR.create_uciwweihr_model_params-Tuple{}","page":"REFERENCE","title":"UCIWWEIHR.create_uciwweihr_model_params","text":"create_uciwweihr_model_params(; kwargs...)\n\nCreates a uciwweihr_sim_params struct with the option to either use a predetermined Rt and w or generate them as random walks.\n\nArguments\n\nkwargs...: Named arguments corresponding to the fields in uciwweihr_sim_params.\n\nReturns\n\nparams::uciwweihr_sim_params: A struct with simulation parameters.\n\n\n\n\n\n","category":"method"},{"location":"reference/#UCIWWEIHR.create_uciwweihr_sim_params-Tuple{}","page":"REFERENCE","title":"UCIWWEIHR.create_uciwweihr_sim_params","text":"createuciwweihrsim_params(; kwargs...)\n\nCreates a uciwweihr_sim_params struct with the option to either use a predetermined Rt and w or generate them as random walks.\n\nArguments\n\nkwargs...: Named arguments corresponding to the fields in uciwweihr_sim_params.\n\nReturns\n\nparams::uciwweihr_sim_params: A struct with simulation parameters.\n\n\n\n\n\n","category":"method"},{"location":"reference/#UCIWWEIHR.eihr_ode!-NTuple{4, Any}","page":"REFERENCE","title":"UCIWWEIHR.eihr_ode!","text":"eihr_ode!(du, u, p, t)\n\nCalculate the ordinary differential equations (ODEs) for the EIHR model.\n\nParameters:\n\ndu: Array{Float64,1} - The derivative of the state variables.\nu: Array{Float64,1} - The current state variables.\np: Tuple{Float64,Float64,Float64,Float64,Float64} - The model parameters (alpha, gamma, nu, w, epsilon).\nt: Float64 - The current time.\n\nReturns:\n\ndu: Array{Float64,1} - The derivative of the state variables.\n\n\n\n\n\n","category":"method"},{"location":"reference/#UCIWWEIHR.generate_colors-Tuple{Any}","page":"REFERENCE","title":"UCIWWEIHR.generate_colors","text":"generate_ribbon_colors(number_of_colors)\n\nGenerates a vector with colors for ribbons in plots.\n\n\n\n\n\n","category":"method"},{"location":"reference/#UCIWWEIHR.generate_logit_normal_random_walk-Tuple{Int64, Float64, Float64, Any}","page":"REFERENCE","title":"UCIWWEIHR.generate_logit_normal_random_walk","text":"generate_logit_normal_random_walk(time_points::Int64, sigma::Float64, init_val::Float64)\n\nGenerates a logit-normal random walk time series.\n\nArguments\n\ntime_points::Int64: Number of time points.\nsigma::Float64: Standard deviation of the random walk in logit space.\ninit_val::Float64: Initial value of the random walk on the probability scale.\n\nReturns\n\nwalk::Vector{Float64}: Generated random walk on the probability scale.\n\n\n\n\n\n","category":"method"},{"location":"reference/#UCIWWEIHR.generate_random_walk-Tuple{Int64, Float64, Float64, Any}","page":"REFERENCE","title":"UCIWWEIHR.generate_random_walk","text":"generate_random_walk(time_points::Int64, sigma::Float64, init_val::Float64)\n\nGenerates a random walk time series.\n\nArguments\n\ntime_points::Int64: Number of time points.\nsigma::Float64: Standard deviation of the random walk.\ninit_val::Float64: Initial value of the random walk.\n\nReturns\n\nwalk::Vector{Float64}: Generated random walk.\n\n\n\n\n\n","category":"method"},{"location":"reference/#UCIWWEIHR.generate_simulation_data_agent","page":"REFERENCE","title":"UCIWWEIHR.generate_simulation_data_agent","text":"Generating Simulation Data for Agent Based Model\n\nTo generate simulation data using the agent based model, you can use the generate_simulation_data_agent function defined in the UCIWWEIHR.jl package. This function allows you to customize various parameters for the simulation. NOT FINISHED, STILL NEEDS WW AND RT\n\nFunction Signature\n\nArguments\n\nseed::Int64: Seed for random number generation. Default value is 1.\npop_size::Int64: Size of the population. Default value is 1000.\nI_init::Int64: Initial number of infected individuals. Default value is 200.\nH_init::Int64: Initial number of hospitalized individuals. Default value is 20.\nbeta::Float64: Transmission rate. Default value is 0.001.\ngamma::Float64: Rate of exposed individuals becoming infectious. Default value is 1/4.\nnu::Float64: Rate of infected individuals recovering or getting hospitalized. Default value is 1/7.\nepsilon::Float64: Rate of hospitalized individuals recovering. Default value is 1/5.\nw_init::Float64: Probability of an infected individual becoming hospitalized. Default value is 0.35.\n\nReturns\n\ndf::DataFrame: A DataFrame containing the simulation data with columns Time, S, E, I, H, and R.\n\n\n\n\n\n","category":"function"},{"location":"reference/#UCIWWEIHR.generate_simulation_data_uciwweihr-Tuple{uciwweihr_sim_params}","page":"REFERENCE","title":"UCIWWEIHR.generate_simulation_data_uciwweihr","text":"generate_simulation_data(params::UCIWWEIHRParams)\n\nGenerates simulation data for the UCIWWEIHR ODE compartmental model.\n\nArguments\n\nparams::uciwweihr_sim_params: Struct containing parameters for the simulation.\n\nReturns\n\ndf::DataFrame: A DataFrame containing the simulation data with columns obstimes, log_ww_conc, hosp, rt, and wt.\n\n\n\n\n\n","category":"method"},{"location":"reference/#UCIWWEIHR.is_time_varying_above_n-Tuple{Symbol, Int64}","page":"REFERENCE","title":"UCIWWEIHR.is_time_varying_above_n","text":"is_time_varying_above_n(name, n)\n\nChecks if the time varying parameter is above a given time point.\n\n\n\n\n\n","category":"method"},{"location":"reference/#UCIWWEIHR.mcmcdiags_vis-Tuple{}","page":"REFERENCE","title":"UCIWWEIHR.mcmcdiags_vis","text":"mcmcdiags_vis(...)\n\nDefault visualizer for results of the UCIWWEIHR model, includes posterior/priors of generated quantities and posterior predictive samples for forecasting.  Forecasting plots will have the observed data alongside.\n\nArguments\n\ngq_samples: Generated quantities samples from the posterior/prior distribution, index 2 in uciwweihrgqpp output.\ndesired_params: A list of lists of parameters to visualize. Each list will be visualized in a separate plot. Default is [[\"Einit\", \"Iinit\", \"Hinit\"], [\"gamma\", \"nu\", \"epsilon\"], [\"rhogene\", \"tau\"], [\"sigma_hosp\"]].\nactual_non_time_varying_vals::uciwweihr_sim_params: A uciwweihrsimparams object of actual non-time varying parameter values if user has access to them. Default is nothing.\nsave_plots::Bool=false: A boolean to indicate if user wants to save the plots as pngs into a plots folder.\nplot_name_to_save: A string to indicate the name of the plot to save. Default is \"mcmcdiagnosisplots\".\n\n\n\n\n\n","category":"method"},{"location":"reference/#UCIWWEIHR.non_time_varying_param_vis-Tuple{uciwweihr_model_params, Vararg{Any, 6}}","page":"REFERENCE","title":"UCIWWEIHR.non_time_varying_param_vis","text":"non_time_varying_param_vis(...)\n\nUsed in the uciwweihr_visualizer to create visuals for non-time varying parameters.\n\nArguments\n\nbuild_params::uciwweihr_model_params: A struct of model parameters used to build gq_samples, used only if user desired priors next to posteriors.\ndata_hosp: Hospitalization data, used only if user desired priors next to posteriors.\ndata_wastewater: Wastewater data, if model does not use this do not specify this, if user desires priors next to plot (do not specify if you do not want prior plots).\nobstimes_hosp: An array of time points for hospital data, used only if user desired priors next to posteriors.\nobstimes_wastewater: An array of time points for wastewater data, used only if user desired priors next to posteriors.\nparam_change_times: An array of time points where the parameters change, used only if user desired priors next to posteriors.\nseed: An integer to set the seed for reproducibility, used only if user desired priors next to posteriors.\nforecast: A boolean to indicate if user wants to forecast, used only if user desired priors next to posteriors.\nforecast_weeks: An integer to indicate the number of weeks to forecast, used only if user desired priors next to posteriors.\ngq_samples: Generated quantities samples from the posterior/prior distribution, index 2 in uciwweihrgqpp output.\ndesired_params: A list of lists of parameters to visualize. Each list will be visualized in a separate plot. Default is any parameter not in this list : [\"alphat\", \"wt\", \"rtvals\", \"loggenes_mean\", \"H\"]\nactual_non_time_varying_vals::uciwweihr_sim_params: A uciwweihrsimparams object of actual non-time varying parameter values if user has access to them. Default is nothing.\nsave_plots::Bool=false: A boolean to indicate if user wants to save the plots as pngs into a plots folder.\nplot_name_to_save: A string to indicate the name of the plot to save. Default is \"mcmcnontimevaryingparameterplots\".\n\n\n\n\n\n","category":"method"},{"location":"reference/#UCIWWEIHR.ode_solution_vis-Tuple{}","page":"REFERENCE","title":"UCIWWEIHR.ode_solution_vis","text":"ode_solution_vis(...)\n\nVisualizer for ODE solutions produced by the UCIWWEIHR model.  If actual ode solutions are provided, they will be included in the plots.\n\nArguments\n\ngq_samples: Generated quantities samples from the posterior/prior distribution, index 2 in uciwweihrgqpp output.\nactual_non_time_varying_vals::uciwweihr_sim_params: A uciwweihrsimparams object of actual non-time varying parameter values if user has access to them. Default is nothing.\nsave_plots::Bool=false: A boolean to indicate if user wants to save the plots as pngs into a plots folder.\nplot_name_to_save: A string to indicate the name of the plot to save. Default is \"mcmcdiagnosisplots\".\n\n\n\n\n\n","category":"method"},{"location":"reference/#UCIWWEIHR.power-Tuple{Any, Any}","page":"REFERENCE","title":"UCIWWEIHR.power","text":"power(a,b)\n\nRaise `a` to the `b` power\n\n\n\n\n\n","category":"method"},{"location":"reference/#UCIWWEIHR.predictive_param_vis-Tuple{}","page":"REFERENCE","title":"UCIWWEIHR.predictive_param_vis","text":"predictive_param_vis(...)\n\nUsed in the uciwweihr_visualizer to create visuals for wastewater data and hospitalization data.\n\nArguments\n\npp_samples: A DataFrame of posterior or prior predictive samples.\ndata_wastewater: An array of actual wastewater values if user has access to them assumed, using time scale of observed time points.  Default is nothing.\ndata_hosp: An array of actual hospitalization values if user has access to them assumed, , using time scale of observed time points.  Default is nothing.\nforecast_weeks: An integer of the number of weeks forecasted. Default is 0.\nvars_to_pred: A list of variables to predict. Default is [\"datawastewater\", \"datahosp\"].\nquantiles: A list of quantiles to calculate for ploting uncertainty. Default is [0.5, 0.8, 0.95].\nbayes_dist_type: A string to indicate if user is using Posterior or Prior distribution. Default is \"Posterior\".\nsave_plots::Bool=false: A boolean to indicate if user wants to save the plots as pngs into a plots folder.\nplot_name_to_save: A string to indicate the name of the plot to save. Default is \"mcmcpredparameter_plots\".\n\n\n\n\n\n","category":"method"},{"location":"reference/#UCIWWEIHR.repeat_last_n_elements-Union{Tuple{T}, Tuple{Vector{T}, Int64, Int64}} where T","page":"REFERENCE","title":"UCIWWEIHR.repeat_last_n_elements","text":"repeat_last_n_elements(x::Vector{T}, n::Int, w::Int) where T\n\nModifies a given array so that the last n elements are repeated w times.\n\n\n\n\n\n","category":"method"},{"location":"reference/#UCIWWEIHR.repeated_forecast-NTuple{4, Any}","page":"REFERENCE","title":"UCIWWEIHR.repeated_forecast","text":"repeated_forecast(...)\n\nThis is the function to make repreated forecast for a given forecast time span, n_forecast_weeks, and for given time points, forecast_points. Plots can be made for these forecasts.  The output is an array of uciwweihr_gq_pp results for each forecast_points.\n\nArguments\n\ndata_hosp: The hospitalization data.\ndata_wastewater: The wastewater data.\nobstimes_hosp: The time points for the hospitalization data.\nobstimes_wastewater: The time points for the wastewater data.\nn_samples: The number of samples to draw from the posterior.\nparam_change_times: The time points where the parameters change.\nparams::uciwweihr_model_params: The model parameters.\nn_forecast_weeks: The number of weeks to forecast.\nforecast_points: The time points to forecast, thees points should be present in obstimes_hosp.\n\nReturns\n\nAn array of uciwweihr_gq_pp resuts and timeseries used for building for each forecast_points.\n\n\n\n\n\n","category":"method"},{"location":"reference/#UCIWWEIHR.save_plots_to_docs-Tuple{Any, Any}","page":"REFERENCE","title":"UCIWWEIHR.save_plots_to_docs","text":"save_plots_to_docs(plot, filename; format = \"png\")\n\nSaves plots to docs/plots directory.\n\n\n\n\n\n","category":"method"},{"location":"reference/#UCIWWEIHR.startswith_any-Tuple{Any, Any}","page":"REFERENCE","title":"UCIWWEIHR.startswith_any","text":"startswith_any(name, patterns)\n\nChecks if the name of time varying paramter starts with any of the patterns.\n\n\n\n\n\n","category":"method"},{"location":"reference/#UCIWWEIHR.subset_desired_ode_from_gq-Tuple{Any, Regex}","page":"REFERENCE","title":"UCIWWEIHR.subset_desired_ode_from_gq","text":"subset_desired_ode_from_gq(gq, desired_var::Regex)\n\nSubsets the generated quantities dataframe from the uciwweihr_gq_pp output to only include the desired variable. desired_var should be put in the following form : r\"I(\\[|\\])\" for example.\n\n\n\n\n\n","category":"method"},{"location":"reference/#UCIWWEIHR.uciwweihr_fit-NTuple{4, Any}","page":"REFERENCE","title":"UCIWWEIHR.uciwweihr_fit","text":"uciwweihr_fit(...)\n\nThis is the sampler for the bayesian semi-parametric model for the wastewater EIHR compartmental model.   The defaults for this fuction will follow those of the default simulation in generatesimulationdatawweihr.jl function.\n\nArguments\n\ndata_hosp: An array of hospital data.\ndata_wastewater: An array of pathogen genome concentration in localized wastewater data.  If this is not avaliable, the model used will be one that only uses hospital data.\nobstimes: An array of timepoints for observed hosp/wastewater.\npriors_only::Bool=false: A boolean to indicate if only priors are to be sampled.\nn_samples::Int64=500: Number of samples to be drawn.\nn_chains::Int64=1: Number of chains to be run.\nseed::Int64=2024: Seed for the random number generator.\nparams::uciwweihr_model_params: A struct containing parameters for the model.\n\nReturns\n\nSamples from the posterior or prior distribution.\n\n\n\n\n\n","category":"method"},{"location":"reference/#UCIWWEIHR.uciwweihr_model-NTuple{4, Any}","page":"REFERENCE","title":"UCIWWEIHR.uciwweihr_model","text":"uciwweihr_model(...)\n\nThis is the bayesian semi-parametric model for the wastewater EIHR compartmental model.   The defaults for this fuction will follow those of the default simulation in generatesimulationdatawweihr.jl function.\n\nArguments\n\ndata_hosp: An array of hospital data.\ndata_wastewater: An array of pathogen genome concentration in localized wastewater data.  If this is not avaliable, the model used will be one that only uses hospital data.\nobstimes_hosp: An array of timepoints for observed hospital data.\nobstimes_wastewater: An array of timepoints for observed wastewater data.\nparam_change_times: An array of timepoints where the parameters change.\nparams::uciwweihr_model_params: A struct containing parameters for the model.\n\n\n\n\n\n","category":"method"},{"location":"tutorials/uciwweihr_simulation_data/#uciwweihr_simulation_data","page":"UCIWWEIHR SIMULATION DATA","title":"Generating simulated data with UCIWWEIHR ODE compartmental based model.","text":"","category":"section"},{"location":"tutorials/uciwweihr_simulation_data/","page":"UCIWWEIHR SIMULATION DATA","title":"UCIWWEIHR SIMULATION DATA","text":"This package provides a way to also simulate data using the UCIWWEIHR ODE compartmental based model specified in the future paper.  The function called generate_simulation_data_uciwweihr.jl can be used to generate synthetic data for a given number of samples and features.  Here we provide a demonstration using the default settings of generate_simulation_data_uciwweihr.jl :","category":"page"},{"location":"tutorials/uciwweihr_simulation_data/#1.-Functionality.","page":"UCIWWEIHR SIMULATION DATA","title":"1. Functionality.","text":"","category":"section"},{"location":"tutorials/uciwweihr_simulation_data/","page":"UCIWWEIHR SIMULATION DATA","title":"UCIWWEIHR SIMULATION DATA","text":"using UCIWWEIHR\nusing Plots\n# Running simulation function with defaults\nparams = create_uciwweihr_sim_params()\ndf = generate_simulation_data_uciwweihr(params)\nfirst(df, 5)","category":"page"},{"location":"tutorials/uciwweihr_simulation_data/#1.2-Visualizing-UCIWWEIHR-model-results.","page":"UCIWWEIHR SIMULATION DATA","title":"1.2 Visualizing UCIWWEIHR model results.","text":"","category":"section"},{"location":"tutorials/uciwweihr_simulation_data/","page":"UCIWWEIHR SIMULATION DATA","title":"UCIWWEIHR SIMULATION DATA","text":"Here we can make simple plots to visualize the data generated using the Plots package.","category":"page"},{"location":"tutorials/uciwweihr_simulation_data/#1.2.1.-Concentration-of-pathogen-genome-in-wastewater(WW).","page":"UCIWWEIHR SIMULATION DATA","title":"1.2.1. Concentration of pathogen genome in wastewater(WW).","text":"","category":"section"},{"location":"tutorials/uciwweihr_simulation_data/","page":"UCIWWEIHR SIMULATION DATA","title":"UCIWWEIHR SIMULATION DATA","text":"plot(df.obstimes, df.log_ww_conc,\n    label=nothing,\n    xlabel=\"Obstimes\", \n    ylabel=\"Conc. of Pathogen Genome in WW\", \n    title=\"Plot of Conc. of Pathogen Genome in WW Over Time\")","category":"page"},{"location":"tutorials/uciwweihr_simulation_data/#1.2.2.-Hospitalizations.","page":"UCIWWEIHR SIMULATION DATA","title":"1.2.2. Hospitalizations.","text":"","category":"section"},{"location":"tutorials/uciwweihr_simulation_data/","page":"UCIWWEIHR SIMULATION DATA","title":"UCIWWEIHR SIMULATION DATA","text":"plot(df.obstimes, df.hosp, \n    label=nothing,\n    xlabel=\"Obstimes\", \n    ylabel=\"Hosp\", \n    title=\"Plot of Hosp Over Time\")","category":"page"},{"location":"tutorials/uciwweihr_simulation_data/#1.2.3.-Reproductive-number.","page":"UCIWWEIHR SIMULATION DATA","title":"1.2.3. Reproductive number.","text":"","category":"section"},{"location":"tutorials/uciwweihr_simulation_data/","page":"UCIWWEIHR SIMULATION DATA","title":"UCIWWEIHR SIMULATION DATA","text":"plot(df.obstimes, df.rt, \n    label=nothing,\n    xlabel=\"Obstimes\", \n    ylabel=\"Rt\", \n    title=\"Plot of Rt Over Time\")","category":"page"},{"location":"tutorials/uciwweihr_simulation_data/#1.2.4.-Hospitalization-rate.","page":"UCIWWEIHR SIMULATION DATA","title":"1.2.4. Hospitalization rate.","text":"","category":"section"},{"location":"tutorials/uciwweihr_simulation_data/","page":"UCIWWEIHR SIMULATION DATA","title":"UCIWWEIHR SIMULATION DATA","text":"plot(df.obstimes, df.wt, \n    label=nothing,\n    xlabel=\"Obstimes\", \n    ylabel=\"Rt\", \n    title=\"Plot of Hospitalization Rate Over Time\")","category":"page"},{"location":"tutorials/uciwweihr_simulation_data/#2.-Alternate-Functionality.","page":"UCIWWEIHR SIMULATION DATA","title":"2. Alternate Functionality.","text":"","category":"section"},{"location":"tutorials/uciwweihr_simulation_data/","page":"UCIWWEIHR SIMULATION DATA","title":"UCIWWEIHR SIMULATION DATA","text":"We can also use a prespecified effective repordcution number curve or a prespecified hospitaliation probability curve.  Any combintation of presepcified or random walk curves can be used.  Here we provide an example of using both a prespecified effective reproduction number curve and a prespecified hospitalization probability curve.","category":"page"},{"location":"tutorials/uciwweihr_simulation_data/","page":"UCIWWEIHR SIMULATION DATA","title":"UCIWWEIHR SIMULATION DATA","text":"using UCIWWEIHR\nusing Plots\n# Running simulation function with prespecified Rt and hospitalization probability\nrt_custom = vcat(\n    range(1, stop=1.8, length=7*4),\n    fill(1.8, 7*2),\n    range(1.8, stop=1, length=7*8),\n    range(0.98, stop=0.8, length=7*2),\n    range(0.8, stop=1.1, length=7*6),\n    range(1.1, stop=0.97, length=7*3)\n)\nw_custom = vcat(\n    range(0.3, stop=0.38, length=7*5),\n    fill(0.38, 7*2),\n    range(0.38, stop=0.25, length=7*8),\n    range(0.25, stop=0.28, length=7*2),\n    range(0.28, stop=0.34, length=7*6),\n    range(0.34, stop=0.28, length=7*2)\n)\nparams = create_uciwweihr_sim_params(\n    time_points = length(rt_custom),\n    Rt = rt_custom, \n    w = w_custom\n)\ndf = generate_simulation_data_uciwweihr(params)\nfirst(df, 5)","category":"page"},{"location":"tutorials/uciwweihr_simulation_data/#2.2-Visualizing-UCIWWEIHR-model-results.","page":"UCIWWEIHR SIMULATION DATA","title":"2.2 Visualizing UCIWWEIHR model results.","text":"","category":"section"},{"location":"tutorials/uciwweihr_simulation_data/","page":"UCIWWEIHR SIMULATION DATA","title":"UCIWWEIHR SIMULATION DATA","text":"We can visualize these results using the Plots package.","category":"page"},{"location":"tutorials/uciwweihr_simulation_data/#2.2.1.-Concentration-of-pathogen-genome-in-wastewater(WW).","page":"UCIWWEIHR SIMULATION DATA","title":"2.2.1. Concentration of pathogen genome in wastewater(WW).","text":"","category":"section"},{"location":"tutorials/uciwweihr_simulation_data/","page":"UCIWWEIHR SIMULATION DATA","title":"UCIWWEIHR SIMULATION DATA","text":"plot(df.obstimes, df.log_ww_conc,\n    label=nothing,\n    xlabel=\"Obstimes\", \n    ylabel=\"Conc. of Pathogen Genome in WW\", \n    title=\"Plot of Conc. of Pathogen Genome in WW Over Time\")","category":"page"},{"location":"tutorials/uciwweihr_simulation_data/#2.2.2.-Hospitalizations.","page":"UCIWWEIHR SIMULATION DATA","title":"2.2.2. Hospitalizations.","text":"","category":"section"},{"location":"tutorials/uciwweihr_simulation_data/","page":"UCIWWEIHR SIMULATION DATA","title":"UCIWWEIHR SIMULATION DATA","text":"plot(df.obstimes, df.hosp, \n    label=nothing,\n    xlabel=\"Obstimes\", \n    ylabel=\"Hosp\", \n    title=\"Plot of Hosp Over Time\")","category":"page"},{"location":"tutorials/uciwweihr_simulation_data/#2.2.3.-Reproductive-number.","page":"UCIWWEIHR SIMULATION DATA","title":"2.2.3. Reproductive number.","text":"","category":"section"},{"location":"tutorials/uciwweihr_simulation_data/","page":"UCIWWEIHR SIMULATION DATA","title":"UCIWWEIHR SIMULATION DATA","text":"plot(df.obstimes, df.rt, \n    label=nothing,\n    xlabel=\"Obstimes\", \n    ylabel=\"Rt\", \n    title=\"Plot of Rt Over Time\")","category":"page"},{"location":"tutorials/uciwweihr_simulation_data/#2.2.4.-Hospitalization-rate.","page":"UCIWWEIHR SIMULATION DATA","title":"2.2.4. Hospitalization rate.","text":"","category":"section"},{"location":"tutorials/uciwweihr_simulation_data/","page":"UCIWWEIHR SIMULATION DATA","title":"UCIWWEIHR SIMULATION DATA","text":"plot(df.obstimes, df.wt, \n    label=nothing,\n    xlabel=\"Obstimes\", \n    ylabel=\"Rt\", \n    title=\"Plot of Hospitalization Rate Over Time\")","category":"page"},{"location":"tutorials/uciwweihr_simulation_data/#[Tutorial-Contents](@ref-tutorial_home)","page":"UCIWWEIHR SIMULATION DATA","title":"Tutorial Contents","text":"","category":"section"},{"location":"#UCIWWEIHR.jl","page":"HOME","title":"UCIWWEIHR.jl","text":"","category":"section"},{"location":"","page":"HOME","title":"HOME","text":"Welcome to the UCIWWEIHR.jl package documentation!  CURRENTLY UNDER DEVELOPMENT!!!","category":"page"},{"location":"","page":"HOME","title":"HOME","text":"By : Christian O. Bernal Zelaya & Volodymyr M. Minin.","category":"page"},{"location":"#Introduction","page":"HOME","title":"Introduction","text":"","category":"section"},{"location":"","page":"HOME","title":"HOME","text":"UCIWWEIHR.jl is a Julia package for forecasting and nowcasting COVID-19 hospitalizations using pathogen genome concentrations. UCIWWEIHR.jl Package License","category":"page"},{"location":"#Features","page":"HOME","title":"Features","text":"","category":"section"},{"location":"","page":"HOME","title":"HOME","text":"Comprehensive library of Bayesian models\nSimulation of infectious disease \nModel calibration\nSensitivity analysis and uncertainty quantification?\nVisualization of results and MCMC evaluations(live?)","category":"page"},{"location":"#Installation","page":"HOME","title":"Installation","text":"","category":"section"},{"location":"","page":"HOME","title":"HOME","text":"To install UCIWWEIHR.jl, you can use the Julia package manager. Open the Julia REPL and run the following command:","category":"page"},{"location":"","page":"HOME","title":"HOME","text":"using Pkg\nPkg.add(\"https://github.com/cbernalz/UCIWWEIHR.jl.git\")","category":"page"}]
}
