<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>UCIWWEIHR FITTING MODEL W/ FORECASTING · UCIWWEIHR.jl</title><meta name="title" content="UCIWWEIHR FITTING MODEL W/ FORECASTING · UCIWWEIHR.jl"/><meta property="og:title" content="UCIWWEIHR FITTING MODEL W/ FORECASTING · UCIWWEIHR.jl"/><meta property="twitter:title" content="UCIWWEIHR FITTING MODEL W/ FORECASTING · UCIWWEIHR.jl"/><meta name="description" content="Documentation for UCIWWEIHR.jl."/><meta property="og:description" content="Documentation for UCIWWEIHR.jl."/><meta property="twitter:description" content="Documentation for UCIWWEIHR.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">UCIWWEIHR.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">HOME</a></li><li><span class="tocitem">TUTORIALS</span><ul><li><a class="tocitem" href="../../tutorial_index/">TUTORIAL CONTENTS</a></li><li><a class="tocitem" href="../getting_started/">GETTING STARTED</a></li><li><a class="tocitem" href="../uciwweihr_simulation_data/">UCIWWEIHR SIMULATION DATA</a></li><li><a class="tocitem" href="../uciwwiehr_model_fitting_no_forecast/">UCIWWEIHR FITTING MODEL W/OUT FORECASTING</a></li><li class="is-active"><a class="tocitem" href>UCIWWEIHR FITTING MODEL W/ FORECASTING</a><ul class="internal"><li><a class="tocitem" href="#1.-Data-Generation."><span>1. Data Generation.</span></a></li><li><a class="tocitem" href="#2.-Sampling-from-the-Posterior-Distribution-and-Posterior-Predictive-Distribution."><span>2. Sampling from the Posterior Distribution and Posterior Predictive Distribution.</span></a></li><li><a class="tocitem" href="#3.-MCMC-Diagnostic-Plots/Results-Along-with-Posterior-Predictive-Distribution."><span>3. MCMC Diagnostic Plots/Results Along with Posterior Predictive Distribution.</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../../reference/">REFERENCE</a></li><li><a class="tocitem" href="../../license/">LICENSE</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">TUTORIALS</a></li><li class="is-active"><a href>UCIWWEIHR FITTING MODEL W/ FORECASTING</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>UCIWWEIHR FITTING MODEL W/ FORECASTING</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://cbernalz.github.io/UCIWWEIHR.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/cbernalz/UCIWWEIHR.jl/blob/master/docs/src/tutorials/uciwwiehr_model_fitting_forecast.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="uciwwiehr_model_fitting_with_forecast"><a class="docs-heading-anchor" href="#uciwwiehr_model_fitting_with_forecast">Generating Posterior Distribution Samples with UCIWWEIHR ODE Compartmental Based Model with Forecasting.</a><a id="uciwwiehr_model_fitting_with_forecast-1"></a><a class="docs-heading-anchor-permalink" href="#uciwwiehr_model_fitting_with_forecast" title="Permalink"></a></h1><p>Here we extend the <a href="../uciwwiehr_model_fitting_no_forecast/#uciwwiehr_model_fitting_no_forecast">previous tutorial</a>  to include forecasting capabilities.  We start with generating out data using <code>generate_simulation_data_uciwweihr</code>&#39;s alternate parameterization where we do not prespecify the effective reproduction number and hospitalization probability but instead preform a log-normal random walk and a logit-normal random walk respectively.  We then sample from the posterior distribution using the <code>uciwweihr_fit.jl</code> function.  We then generate desired quantities and forecast for a given time period with the posterior predictive distribution, using <code>uciwweihr_gq_pp.jl</code>.</p><h2 id="1.-Data-Generation."><a class="docs-heading-anchor" href="#1.-Data-Generation.">1. Data Generation.</a><a id="1.-Data-Generation.-1"></a><a class="docs-heading-anchor-permalink" href="#1.-Data-Generation." title="Permalink"></a></h2><p>Here we generate two datasets, one with 150 time points and one with 178 time points.  We will use the 150 time point dataset for fitting and the 178 time point dataset for forecast evaluation.</p><pre><code class="language-julia hljs">using UCIWWEIHR
# Running simulation function with presets
params = create_uciwweihr_sim_params(
    time_points = 70
)
df = generate_simulation_data_uciwweihr(params)

params_ext = create_uciwweihr_sim_params(
    time_points = 84
)
df_ext = generate_simulation_data_uciwweihr(params_ext)
first(df, 5)</code></pre><div><div style = "float: left;"><span>5×8 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">obstimes</th><th style = "text-align: left;">log_ww_conc</th><th style = "text-align: left;">hosp</th><th style = "text-align: left;">rt</th><th style = "text-align: left;">wt</th><th style = "text-align: left;">E_ode_comp_sol</th><th style = "text-align: left;">I_ode_comp_sol</th><th style = "text-align: left;">H_ode_comp_sol</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "Int64" style = "text-align: left;">Int64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Int64" style = "text-align: left;">Int64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: right;">1</td><td style = "text-align: right;">0.0882519</td><td style = "text-align: right;">26</td><td style = "text-align: right;">0.99777</td><td style = "text-align: right;">0.349492</td><td style = "text-align: right;">200.0</td><td style = "text-align: right;">100.0</td><td style = "text-align: right;">20.0</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: right;">2</td><td style = "text-align: right;">0.407202</td><td style = "text-align: right;">20</td><td style = "text-align: right;">1.01468</td><td style = "text-align: right;">0.353323</td><td style = "text-align: right;">170.442</td><td style = "text-align: right;">129.53</td><td style = "text-align: right;">21.6357</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: right;">3</td><td style = "text-align: right;">0.416729</td><td style = "text-align: right;">26</td><td style = "text-align: right;">0.989119</td><td style = "text-align: right;">0.347515</td><td style = "text-align: right;">150.77</td><td style = "text-align: right;">149.497</td><td style = "text-align: right;">24.1411</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: right;">4</td><td style = "text-align: right;">0.829472</td><td style = "text-align: right;">23</td><td style = "text-align: right;">1.06904</td><td style = "text-align: right;">0.365335</td><td style = "text-align: right;">137.051</td><td style = "text-align: right;">162.981</td><td style = "text-align: right;">26.8269</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: right;">5</td><td style = "text-align: right;">0.75552</td><td style = "text-align: right;">31</td><td style = "text-align: right;">1.10915</td><td style = "text-align: right;">0.373918</td><td style = "text-align: right;">129.444</td><td style = "text-align: right;">172.241</td><td style = "text-align: right;">29.9119</td></tr></tbody></table></div><pre><code class="language-julia hljs">first(df_ext, 5)</code></pre><div><div style = "float: left;"><span>5×8 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">obstimes</th><th style = "text-align: left;">log_ww_conc</th><th style = "text-align: left;">hosp</th><th style = "text-align: left;">rt</th><th style = "text-align: left;">wt</th><th style = "text-align: left;">E_ode_comp_sol</th><th style = "text-align: left;">I_ode_comp_sol</th><th style = "text-align: left;">H_ode_comp_sol</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "Int64" style = "text-align: left;">Int64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Int64" style = "text-align: left;">Int64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: right;">1</td><td style = "text-align: right;">0.0882519</td><td style = "text-align: right;">17</td><td style = "text-align: right;">0.99777</td><td style = "text-align: right;">0.349492</td><td style = "text-align: right;">200.0</td><td style = "text-align: right;">100.0</td><td style = "text-align: right;">20.0</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: right;">2</td><td style = "text-align: right;">0.407202</td><td style = "text-align: right;">32</td><td style = "text-align: right;">1.01468</td><td style = "text-align: right;">0.353323</td><td style = "text-align: right;">170.442</td><td style = "text-align: right;">129.53</td><td style = "text-align: right;">21.6357</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: right;">3</td><td style = "text-align: right;">0.416729</td><td style = "text-align: right;">18</td><td style = "text-align: right;">0.989119</td><td style = "text-align: right;">0.347515</td><td style = "text-align: right;">150.77</td><td style = "text-align: right;">149.497</td><td style = "text-align: right;">24.1411</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: right;">4</td><td style = "text-align: right;">0.829472</td><td style = "text-align: right;">28</td><td style = "text-align: right;">1.06904</td><td style = "text-align: right;">0.365335</td><td style = "text-align: right;">137.051</td><td style = "text-align: right;">162.981</td><td style = "text-align: right;">26.8269</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: right;">5</td><td style = "text-align: right;">0.75552</td><td style = "text-align: right;">26</td><td style = "text-align: right;">1.10915</td><td style = "text-align: right;">0.373918</td><td style = "text-align: right;">129.444</td><td style = "text-align: right;">172.241</td><td style = "text-align: right;">29.9119</td></tr></tbody></table></div><h2 id="2.-Sampling-from-the-Posterior-Distribution-and-Posterior-Predictive-Distribution."><a class="docs-heading-anchor" href="#2.-Sampling-from-the-Posterior-Distribution-and-Posterior-Predictive-Distribution.">2. Sampling from the Posterior Distribution and Posterior Predictive Distribution.</a><a id="2.-Sampling-from-the-Posterior-Distribution-and-Posterior-Predictive-Distribution.-1"></a><a class="docs-heading-anchor-permalink" href="#2.-Sampling-from-the-Posterior-Distribution-and-Posterior-Predictive-Distribution." title="Permalink"></a></h2><p>Here we sample from the posterior distribution using the <code>uciwweihr_fit.jl</code> function.  First, we setup some presets, where we need to use <code>create_uciwweihr_model_params()</code> to get default parameters for the model.  Then we have an array where index 1 contains the posterior/prior predictive samples, index 2 contains the posterior/prior generated quantities samples, and index 3 contains the original sampled parameters for the model.  The difference here is that we set <code>forecast = true</code> and <code>forecast_weeks = 4</code> to forecast 4 weeks into the future.  One other thing to note, is that we allow misalignment of hospital and wastewater data&#39;s observed times.  For this tutorial, we use the same observed points.</p><pre><code class="language-julia hljs">data_hosp = df.hosp
data_wastewater = df.log_ww_conc
obstimes_hosp = df.obstimes
obstimes_wastewater = df.obstimes
max_obstime = max(length(obstimes_hosp), length(obstimes_wastewater))
param_change_times = 1:7:max_obstime # Change every week
priors_only = false
n_samples = 500
forecast = true
forecast_days = 14

E_init_sd=0.2; log_E_init_mean=log(200)
I_init_sd=0.2; log_I_init_mean=log(100)
H_init_sd=0.2; log_H_init_mean=log(20)
gamma_sd=0.02; log_gamma_mean=log(1/4)
nu_sd=0.02; log_nu_mean=log(1/7)
epsilon_sd=0.02; log_epsilon_mean=log(1/5)
rho_gene_sd=0.02; log_rho_gene_mean=log(0.011)

sigma_ww_sd=0.02; log_sigma_ww_mean=log(0.1)
sigma_hosp_sd=0.01; log_sigma_hosp_mean=log(500.0)

Rt_init_sd=0.3; Rt_init_mean=0.2
sigma_Rt_sd=0.2; sigma_Rt_mean=-3.0
w_init_sd=0.04; w_init_mean=logit(0.35)
sigma_w_sd=0.2; sigma_w_mean=-3.5
message = true
model_params = create_model_params_time_var_hosp(
    E_init_sd, log_E_init_mean,
    I_init_sd, log_I_init_mean,
    H_init_sd, log_H_init_mean,
    gamma_sd, log_gamma_mean,
    nu_sd, log_nu_mean,
    epsilon_sd, log_epsilon_mean,
    rho_gene_sd, log_rho_gene_mean,
    sigma_ww_sd, log_sigma_ww_mean,
    sigma_hosp_sd, log_sigma_hosp_mean,
    Rt_init_sd, Rt_init_mean,
    sigma_Rt_sd, sigma_Rt_mean,
    w_init_sd, w_init_mean,
    sigma_w_sd, sigma_w_mean,
    message;
)
init_params = optimize_many_MAP2_wrapper(
    data_hosp,
    data_wastewater,
    obstimes_hosp,
    obstimes_wastewater,
    param_change_times,
    model_params;
    verbose=false,
    warning_bool=false,
)
samples = fit(
    data_hosp,
    data_wastewater,
    obstimes_hosp,
    obstimes_wastewater,
    param_change_times,
    model_params;
    priors_only,
    n_samples,
    n_discard_initial = 200,
    n_chains = 1,
    init_params = init_params
    )
model_output = generate_pq_pp(
    samples,
    data_hosp,
    data_wastewater,
    obstimes_hosp,
    obstimes_wastewater,
    param_change_times,
    model_params;
    forecast=true, forecast_days=forecast_days
)

first(model_output[1][:,1:5], 5)</code></pre><div><div style = "float: left;"><span>5×5 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">iteration</th><th style = "text-align: left;">chain</th><th style = "text-align: left;">data_wastewater[1]</th><th style = "text-align: left;">data_wastewater[2]</th><th style = "text-align: left;">data_wastewater[3]</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "Int64" style = "text-align: left;">Int64</th><th title = "Int64" style = "text-align: left;">Int64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: right;">1</td><td style = "text-align: right;">1</td><td style = "text-align: right;">0.227543</td><td style = "text-align: right;">0.545469</td><td style = "text-align: right;">0.45349</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: right;">2</td><td style = "text-align: right;">1</td><td style = "text-align: right;">0.11973</td><td style = "text-align: right;">0.343828</td><td style = "text-align: right;">0.391195</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: right;">3</td><td style = "text-align: right;">1</td><td style = "text-align: right;">0.193544</td><td style = "text-align: right;">0.436968</td><td style = "text-align: right;">0.55912</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: right;">4</td><td style = "text-align: right;">1</td><td style = "text-align: right;">0.333363</td><td style = "text-align: right;">0.39013</td><td style = "text-align: right;">0.601847</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: right;">5</td><td style = "text-align: right;">1</td><td style = "text-align: right;">0.238289</td><td style = "text-align: right;">0.376244</td><td style = "text-align: right;">0.499901</td></tr></tbody></table></div><pre><code class="language-julia hljs">first(model_output[2][:,1:5], 5)</code></pre><div><div style = "float: left;"><span>5×5 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">iteration</th><th style = "text-align: left;">chain</th><th style = "text-align: left;">E_init</th><th style = "text-align: left;">I_init</th><th style = "text-align: left;">H_init</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "Int64" style = "text-align: left;">Int64</th><th title = "Int64" style = "text-align: left;">Int64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: right;">1</td><td style = "text-align: right;">1</td><td style = "text-align: right;">195.868</td><td style = "text-align: right;">73.2736</td><td style = "text-align: right;">18.5444</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: right;">2</td><td style = "text-align: right;">1</td><td style = "text-align: right;">195.868</td><td style = "text-align: right;">73.2736</td><td style = "text-align: right;">18.5444</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: right;">3</td><td style = "text-align: right;">1</td><td style = "text-align: right;">195.868</td><td style = "text-align: right;">73.2736</td><td style = "text-align: right;">18.5444</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: right;">4</td><td style = "text-align: right;">1</td><td style = "text-align: right;">233.251</td><td style = "text-align: right;">82.0257</td><td style = "text-align: right;">20.9294</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: right;">5</td><td style = "text-align: right;">1</td><td style = "text-align: right;">214.583</td><td style = "text-align: right;">75.1761</td><td style = "text-align: right;">19.8653</td></tr></tbody></table></div><pre><code class="language-julia hljs">first(model_output[3][:,1:5], 5)</code></pre><div><div style = "float: left;"><span>5×5 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">iteration</th><th style = "text-align: left;">chain</th><th style = "text-align: left;">E_init_non_centered</th><th style = "text-align: left;">I_init_non_centered</th><th style = "text-align: left;">H_init_non_centered</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "Int64" style = "text-align: left;">Int64</th><th title = "Int64" style = "text-align: left;">Int64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: right;">201</td><td style = "text-align: right;">1</td><td style = "text-align: right;">-0.104386</td><td style = "text-align: right;">-1.55485</td><td style = "text-align: right;">-0.37783</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: right;">202</td><td style = "text-align: right;">1</td><td style = "text-align: right;">-0.104386</td><td style = "text-align: right;">-1.55485</td><td style = "text-align: right;">-0.37783</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: right;">203</td><td style = "text-align: right;">1</td><td style = "text-align: right;">-0.104386</td><td style = "text-align: right;">-1.55485</td><td style = "text-align: right;">-0.37783</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: right;">204</td><td style = "text-align: right;">1</td><td style = "text-align: right;">0.768998</td><td style = "text-align: right;">-0.990691</td><td style = "text-align: right;">0.227118</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: right;">205</td><td style = "text-align: right;">1</td><td style = "text-align: right;">0.351885</td><td style = "text-align: right;">-1.42668</td><td style = "text-align: right;">-0.0337908</td></tr></tbody></table></div><h2 id="3.-MCMC-Diagnostic-Plots/Results-Along-with-Posterior-Predictive-Distribution."><a class="docs-heading-anchor" href="#3.-MCMC-Diagnostic-Plots/Results-Along-with-Posterior-Predictive-Distribution.">3. MCMC Diagnostic Plots/Results Along with Posterior Predictive Distribution.</a><a id="3.-MCMC-Diagnostic-Plots/Results-Along-with-Posterior-Predictive-Distribution.-1"></a><a class="docs-heading-anchor-permalink" href="#3.-MCMC-Diagnostic-Plots/Results-Along-with-Posterior-Predictive-Distribution." title="Permalink"></a></h2><p>We can again look at model diagnostics, posterior distribution of time or non-time varying parameters, and the posterior predictive distribution extended for forecasting.  We can also add certain parameters to ensure priors will be plotted alongside their corresponding posteriors.</p><pre><code class="language-julia hljs">uciwweihr_visualizer(
    data_hosp,
    data_wastewater,
    forecast_days,
    obstimes_hosp,
    obstimes_wastewater,
    param_change_times,
    2024,
    forecast,
    model_params;
    pp_samples = model_output[1],
    gq_samples = model_output[2],
    samples = model_output[3],
    obs_data_hosp = df_ext.hosp,
    obs_data_wastewater = df_ext.log_ww_conc,
    actual_rt_vals = df_ext.rt,
    actual_w_t = df_ext.wt,
    actual_E_ode_sol = df.E_ode_comp_sol,
    actual_I_ode_sol = df.I_ode_comp_sol,
    actual_H_ode_sol = df.H_ode_comp_sol,
    actual_non_time_varying_vals = params,
    bayes_dist_type = &quot;Posterior&quot;,
    save_plots = true,
    plot_name_to_save_mcmcdiag = &quot;plots/mcmc_diagnosis_plots1&quot;,
    plot_name_to_save_time_varying = &quot;plots/mcmc_time_varying_parameter_plots1&quot;,
    plot_name_to_save_non_time_varying = &quot;plots/mcmc_nontime_varying_parameter_plots1&quot;,
    plot_name_to_save_ode_sol = &quot;plots/mcmc_ode_solution_plots1&quot;,
    plot_name_to_save_pred_param = &quot;plots/mcmc_pred_parameter_plots1&quot;,
    plot_name_to_save_log_like = &quot;plots/mcmc_log_prob_trace_plot1&quot;
)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Effective Sample Size for E_init for Chain 1: 385.0
Effective Sample Size for I_init for Chain 1: 454.0
Effective Sample Size for H_init for Chain 1: 646.0
Effective Sample Size for gamma for Chain 1: 819.0
Effective Sample Size for nu for Chain 1: 619.0
Effective Sample Size for epsilon for Chain 1: 528.0
Effective Sample Size for rt_init for Chain 1: 318.0
Effective Sample Size for w_init for Chain 1: 433.0
Effective Sample Size for sigma_w for Chain 1: 450.0
Effective Sample Size for sigma_Rt for Chain 1: 568.0
Effective Sample Size for sigma_ww for Chain 1: 659.0
Effective Sample Size for sigma_hosp for Chain 1: 652.0
Effective Sample Size for rho_gene for Chain 1: 415.0
Plot saved to plots/mcmc_diagnosis_plots1.png
Generating time varying parameter plots (with wastewater and time-varying hospitalization probability)...
Using uciwweihr_model with wastewater.  With time-varying hospitalization probability!!!
┌ Warning: Only a single thread available: MCMC chains are not sampled in parallel
└ @ AbstractMCMC ~/.julia/packages/AbstractMCMC/F50rb/src/sample.jl:384
Sampling (1 thread)   0%|                               |  ETA: N/A
Sampling (1 thread) 100%|███████████████████████████████| Time: 0:00:04
Sampling (1 thread) 100%|███████████████████████████████| Time: 0:00:04
Using uciwweihr_model with wastewater and time-varying hospitlaization probability!!!
Generating quantities...
Plot saved to plots/mcmc_time_varying_parameter_plots1.png
Generating non-time varying parameter plots (with wastewater and with time-varying hospitalization probability)...
Using uciwweihr_model with wastewater.  With time-varying hospitalization probability!!!
┌ Warning: Only a single thread available: MCMC chains are not sampled in parallel
└ @ AbstractMCMC ~/.julia/packages/AbstractMCMC/F50rb/src/sample.jl:384
Sampling (1 thread)   0%|                               |  ETA: N/A
Sampling (1 thread) 100%|███████████████████████████████| Time: 0:00:00
Sampling (1 thread) 100%|███████████████████████████████| Time: 0:00:00
Using uciwweihr_model with wastewater and time-varying hospitlaization probability!!!
Generating quantities...
Plot saved to plots/mcmc_nontime_varying_parameter_plots1.png
Plot saved to plots/mcmc_ode_solution_plots1.png
Plot saved to plots/mcmc_pred_parameter_plots1.png
Plot saved to plots/mcmc_log_prob_trace_plot1.png</code></pre><h3 id="3.1.-MCMC-Diagnostic-Plots."><a class="docs-heading-anchor" href="#3.1.-MCMC-Diagnostic-Plots.">3.1. MCMC Diagnostic Plots.</a><a id="3.1.-MCMC-Diagnostic-Plots.-1"></a><a class="docs-heading-anchor-permalink" href="#3.1.-MCMC-Diagnostic-Plots." title="Permalink"></a></h3><p><img src="../plots/mcmc_diagnosis_plots1.png" alt="Plot 1"/></p><h3 id="3.2.-Time-Varying-Parameter-Results-Plot."><a class="docs-heading-anchor" href="#3.2.-Time-Varying-Parameter-Results-Plot.">3.2. Time Varying Parameter Results Plot.</a><a id="3.2.-Time-Varying-Parameter-Results-Plot.-1"></a><a class="docs-heading-anchor-permalink" href="#3.2.-Time-Varying-Parameter-Results-Plot." title="Permalink"></a></h3><p><img src="../plots/mcmc_time_varying_parameter_plots1.png" alt="Plot 2"/></p><h3 id="3.3.-Non-Time-Varying-Parameter-Results-Plot."><a class="docs-heading-anchor" href="#3.3.-Non-Time-Varying-Parameter-Results-Plot.">3.3. Non-Time Varying Parameter Results Plot.</a><a id="3.3.-Non-Time-Varying-Parameter-Results-Plot.-1"></a><a class="docs-heading-anchor-permalink" href="#3.3.-Non-Time-Varying-Parameter-Results-Plot." title="Permalink"></a></h3><p><img src="../plots/mcmc_nontime_varying_parameter_plots1.png" alt="Plot 3"/></p><h3 id="3.4.-ODE-Solution-Plot."><a class="docs-heading-anchor" href="#3.4.-ODE-Solution-Plot.">3.4. ODE Solution Plot.</a><a id="3.4.-ODE-Solution-Plot.-1"></a><a class="docs-heading-anchor-permalink" href="#3.4.-ODE-Solution-Plot." title="Permalink"></a></h3><p><img src="../plots/mcmc_ode_solution_plots1.png" alt="Plot 4"/></p><h3 id="3.5.-Posterior-Predictive-Distribution-Plot."><a class="docs-heading-anchor" href="#3.5.-Posterior-Predictive-Distribution-Plot.">3.5. Posterior Predictive Distribution Plot.</a><a id="3.5.-Posterior-Predictive-Distribution-Plot.-1"></a><a class="docs-heading-anchor-permalink" href="#3.5.-Posterior-Predictive-Distribution-Plot." title="Permalink"></a></h3><p><img src="../plots/mcmc_pred_parameter_plots1.png" alt="Plot 4"/></p><h3 id="3.6.-Log-Prob-Trace-Plot."><a class="docs-heading-anchor" href="#3.6.-Log-Prob-Trace-Plot.">3.6. Log Prob Trace Plot.</a><a id="3.6.-Log-Prob-Trace-Plot.-1"></a><a class="docs-heading-anchor-permalink" href="#3.6.-Log-Prob-Trace-Plot." title="Permalink"></a></h3><p><img src="../plots/mcmc_log_prob_trace_plot1.png" alt="Plot 5"/></p><h3 id="[Tutorial-Contents](@ref-tutorial_home)"><a class="docs-heading-anchor" href="#[Tutorial-Contents](@ref-tutorial_home)"><a href="../../tutorial_index/#tutorial_home">Tutorial Contents</a></a><a id="[Tutorial-Contents](@ref-tutorial_home)-1"></a><a class="docs-heading-anchor-permalink" href="#[Tutorial-Contents](@ref-tutorial_home)" title="Permalink"></a></h3></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../uciwwiehr_model_fitting_no_forecast/">« UCIWWEIHR FITTING MODEL W/OUT FORECASTING</a><a class="docs-footer-nextpage" href="../../reference/">REFERENCE »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.13.0 on <span class="colophon-date" title="Tuesday 24 June 2025 17:30">Tuesday 24 June 2025</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
